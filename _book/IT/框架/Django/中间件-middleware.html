
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>中间件-middleware · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-chapter-fold/chapter-fold.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="性能分析工具-silk.html" />
    
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../../">
            
                <a href="../../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../">
            
                <a href="../../">
            
                    
                    IT
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" >
            
                <span>
            
                    
                    Questions
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="../../Questions/c-windows.html">
            
                <a href="../../Questions/c-windows.html">
            
                    
                    C Windows
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2" data-path="../../Questions/docker consul跨主机网络不通.html">
            
                <a href="../../Questions/docker consul跨主机网络不通.html">
            
                    
                    docker consul跨主机网络不通
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.3" data-path="../../Questions/Redis编译安装-失败问题解决.html">
            
                <a href="../../Questions/Redis编译安装-失败问题解决.html">
            
                    
                    Redis编译安装-失败问题解决
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.4" data-path="../../Questions/winexe阻塞问题.html">
            
                <a href="../../Questions/winexe阻塞问题.html">
            
                    
                    winexe阻塞问题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2" >
            
                <span>
            
                    
                    Tools
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1" >
            
                <span>
            
                    
                    Git
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1.1" data-path="../../Tools/git/推送单次commit.html">
            
                <a href="../../Tools/git/推送单次commit.html">
            
                    
                    推送单次commit
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2.2" data-path="../../Tools/VSCode.html">
            
                <a href="../../Tools/VSCode.html">
            
                    
                    VS Code
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.3" data-path="../../Tools/VSCode安装插件失败问题解决.html">
            
                <a href="../../Tools/VSCode安装插件失败问题解决.html">
            
                    
                    VSCode安装插件失败问题解决
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.4" data-path="../../Tools/VSCode远程调试.html">
            
                <a href="../../Tools/VSCode远程调试.html">
            
                    
                    VSCode远程调试
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.3" >
            
                <span>
            
                    
                    Web服务器
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.3.1" data-path="../../Web服务器/Nginx/Nginx.html">
            
                <a href="../../Web服务器/Nginx/Nginx.html">
            
                    
                    Nginx
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.4" >
            
                <span>
            
                    
                    中间件
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1" >
            
                <span>
            
                    
                    Celery
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1.1" data-path="../../中间件/Celery/Celery task.update_state.html">
            
                <a href="../../中间件/Celery/Celery task.update_state.html">
            
                    
                    Celery task.update_state
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.4.2" >
            
                <span>
            
                    
                    Kafka
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.2.1" data-path="../../中间件/Kafka/Advertise.listerners.html">
            
                <a href="../../中间件/Kafka/Advertise.listerners.html">
            
                    
                    Advertise.listerners
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.2.2" data-path="../../中间件/Kafka/Kafka-性能优化.html">
            
                <a href="../../中间件/Kafka/Kafka-性能优化.html">
            
                    
                    Kafka-性能优化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.2.3" data-path="../../中间件/Kafka/关于kafka顺序读写的思考.html">
            
                <a href="../../中间件/Kafka/关于kafka顺序读写的思考.html">
            
                    
                    关于kafka顺序读写的思考
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.4.3" >
            
                <span>
            
                    
                    Rabbitmq
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.3.1" data-path="../../中间件/Rabbitmq/Rabbitmq-Web界面.html">
            
                <a href="../../中间件/Rabbitmq/Rabbitmq-Web界面.html">
            
                    
                    Rabbitmq-Web界面
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.4.4" data-path="../../中间件/Redis/">
            
                <a href="../../中间件/Redis/">
            
                    
                    Redis
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.4.1" data-path="../../中间件/Redis/Redis Event相关数据结构.html">
            
                <a href="../../中间件/Redis/Redis Event相关数据结构.html">
            
                    
                    Redis Event相关数据结构
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.4.2" data-path="../../中间件/Redis/Redis network相关数据结构.html">
            
                <a href="../../中间件/Redis/Redis network相关数据结构.html">
            
                    
                    Redis network相关数据结构
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.4.3" data-path="../../中间件/Redis/Redis数据结构-dict.html">
            
                <a href="../../中间件/Redis/Redis数据结构-dict.html">
            
                    
                    Redis数据结构-dict
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.4.4" data-path="../../中间件/Redis/Redis源码分析.html">
            
                <a href="../../中间件/Redis/Redis源码分析.html">
            
                    
                    Redis源码分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.4.5" data-path="../../中间件/Redis/sdshdr.html">
            
                <a href="../../中间件/Redis/sdshdr.html">
            
                    
                    Sdshdr
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.4.6" data-path="../../中间件/Redis/string占用空间分析.html">
            
                <a href="../../中间件/Redis/string占用空间分析.html">
            
                    
                    string占用空间分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.4.7" data-path="../../中间件/Redis/utils.html">
            
                <a href="../../中间件/Redis/utils.html">
            
                    
                    Utils
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.4.8" data-path="../../中间件/Redis/数据类型与对象编码.html">
            
                <a href="../../中间件/Redis/数据类型与对象编码.html">
            
                    
                    数据类型与对象编码
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.5" >
            
                <span>
            
                    
                    分布式
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.5.1" >
            
                <span>
            
                    
                    Elastic Search
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.5.1.1" data-path="../../分布式/ElasticSearch/_validate, rewrite 输出分析.html">
            
                <a href="../../分布式/ElasticSearch/_validate, rewrite 输出分析.html">
            
                    
                    _validate, rewrite 输出分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5.1.2" data-path="../../分布式/ElasticSearch/best_fields,most_fields与cross_fields.html">
            
                <a href="../../分布式/ElasticSearch/best_fields,most_fields与cross_fields.html">
            
                    
                    best_fields,most_fields与cross_fields
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../../操作系统/">
            
                <a href="../../操作系统/">
            
                    
                    操作系统
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.6.1" data-path="../../操作系统/ip a命令输出解析.html">
            
                <a href="../../操作系统/ip a命令输出解析.html">
            
                    
                    ip a命令输出解析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.2" data-path="../../操作系统/iptables解析.html">
            
                <a href="../../操作系统/iptables解析.html">
            
                    
                    iptables解析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.3" data-path="../../操作系统/Linux-TC解析.html">
            
                <a href="../../操作系统/Linux-TC解析.html">
            
                    
                    Linux-TC解析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.4" data-path="../../操作系统/Linux-网络.html">
            
                <a href="../../操作系统/Linux-网络.html">
            
                    
                    Linux-网络
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.5" data-path="../../操作系统/Linux-零拷贝.html">
            
                <a href="../../操作系统/Linux-零拷贝.html">
            
                    
                    Linux-零拷贝
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.6" data-path="../../操作系统/Linux性能排查.html">
            
                <a href="../../操作系统/Linux性能排查.html">
            
                    
                    Linux性能排查
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.7" data-path="../../操作系统/Linux文件系统.html">
            
                <a href="../../操作系统/Linux文件系统.html">
            
                    
                    Linux文件系统
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.8" data-path="../../操作系统/NUMA.html">
            
                <a href="../../操作系统/NUMA.html">
            
                    
                    NUMA
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.9" data-path="../../操作系统/OS-CPU Cache.html">
            
                <a href="../../操作系统/OS-CPU Cache.html">
            
                    
                    OS CPU Cache
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.10" data-path="../../操作系统/tcpdump解析.html">
            
                <a href="../../操作系统/tcpdump解析.html">
            
                    
                    tcpdump解析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.11" data-path="../../操作系统/官网文档.html">
            
                <a href="../../操作系统/官网文档.html">
            
                    
                    官网文档
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.12" data-path="../../操作系统/流量处理-DPDK.html">
            
                <a href="../../操作系统/流量处理-DPDK.html">
            
                    
                    流量处理-DPDK
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.13" data-path="../../操作系统/磁盘挂载与文件系统.html">
            
                <a href="../../操作系统/磁盘挂载与文件系统.html">
            
                    
                    磁盘挂载与文件系统
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.14" data-path="../../操作系统/系统监控工具.html">
            
                <a href="../../操作系统/系统监控工具.html">
            
                    
                    系统监控工具
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.15" data-path="../../操作系统/页缓存与块缓存.html">
            
                <a href="../../操作系统/页缓存与块缓存.html">
            
                    
                    页缓存与块缓存
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.7" >
            
                <span>
            
                    
                    数据库
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.7.1" >
            
                <span>
            
                    
                    My SQL
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.7.1.1" data-path="../../数据库/MySQL/MVCC与事务隔离.html">
            
                <a href="../../数据库/MySQL/MVCC与事务隔离.html">
            
                    
                    MVCC与事务隔离
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.1.2" data-path="../../数据库/MySQL/MySQL中的索引.html">
            
                <a href="../../数据库/MySQL/MySQL中的索引.html">
            
                    
                    MySQL中的索引
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.1.3" data-path="../../数据库/MySQL/MySQL日志-Redo Log与Binlog.html">
            
                <a href="../../数据库/MySQL/MySQL日志-Redo Log与Binlog.html">
            
                    
                    MySQL日志-Redo Log与Binlog
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.1.4" data-path="../../数据库/MySQL/事务.html">
            
                <a href="../../数据库/MySQL/事务.html">
            
                    
                    事务
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.1.5" data-path="../../数据库/MySQL/锁.html">
            
                <a href="../../数据库/MySQL/锁.html">
            
                    
                    锁
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.8" >
            
                <span>
            
                    
                    框架
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.8.1" >
            
                <span>
            
                    
                    Django
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.2.8.1.1" data-path="中间件-middleware.html">
            
                <a href="中间件-middleware.html">
            
                    
                    中间件-middleware
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.1.2" data-path="性能分析工具-silk.html">
            
                <a href="性能分析工具-silk.html">
            
                    
                    性能分析工具-silk
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.9" >
            
                <span>
            
                    
                    编程
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.9.1" >
            
                <span>
            
                    
                    Python
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.9.1.1" data-path="../../编程/Python/__dict__.html">
            
                <a href="../../编程/Python/__dict__.html">
            
                    
                    Dict
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9.1.2" data-path="../../编程/Python/magic method.html">
            
                <a href="../../编程/Python/magic method.html">
            
                    
                    Magic Method
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9.1.3" data-path="../../编程/Python/metaclass.html">
            
                <a href="../../编程/Python/metaclass.html">
            
                    
                    Metaclass
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.9.2" >
            
                <span>
            
                    
                    并发编程
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.9.2.1" data-path="../../编程/并发编程/协程解析.html">
            
                <a href="../../编程/并发编程/协程解析.html">
            
                    
                    协程解析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9.2.2" data-path="../../编程/并发编程/可重入函数、可重入锁与threading.Condition.html">
            
                <a href="../../编程/并发编程/可重入函数、可重入锁与threading.Condition.html">
            
                    
                    可重入函数、可重入锁与threading.Condition
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9.2.3" data-path="../../编程/并发编程/进程与线程.html">
            
                <a href="../../编程/并发编程/进程与线程.html">
            
                    
                    进程与线程
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.9.3" data-path="../../编程/Python性能分析工具及优化.html">
            
                <a href="../../编程/Python性能分析工具及优化.html">
            
                    
                    Python性能分析工具及优化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9.4" data-path="../../编程/内存对齐.html">
            
                <a href="../../编程/内存对齐.html">
            
                    
                    内存对齐
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9.5" data-path="../../编程/数据表示 原码、反码和补码.html">
            
                <a href="../../编程/数据表示 原码、反码和补码.html">
            
                    
                    数据表示 原码、反码和补码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9.6" data-path="../../编程/汇编指令.html">
            
                <a href="../../编程/汇编指令.html">
            
                    
                    汇编指令
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.10" >
            
                <span>
            
                    
                    网络
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.10.1" data-path="../../网络/TCP三次握手与四次挥手.html">
            
                <a href="../../网络/TCP三次握手与四次挥手.html">
            
                    
                    TCP三次握手与四次挥手
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.11" data-path="../../虚拟化/">
            
                <a href="../../虚拟化/">
            
                    
                    虚拟化
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.11.1" >
            
                <span>
            
                    
                    Docker
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.11.1.1" data-path="../../虚拟化/Docker/Docker-consul跨主机Overlay网络搭建.html">
            
                <a href="../../虚拟化/Docker/Docker-consul跨主机Overlay网络搭建.html">
            
                    
                    Docker-consul跨主机Overlay网络搭建
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.11.1.2" data-path="../../虚拟化/Docker/Docker-实践.html">
            
                <a href="../../虚拟化/Docker/Docker-实践.html">
            
                    
                    Docker-实践
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.11.1.3" data-path="../../虚拟化/Docker/Docker原理解析.html">
            
                <a href="../../虚拟化/Docker/Docker原理解析.html">
            
                    
                    Docker原理解析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.11.2" >
            
                <span>
            
                    
                    网络
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.11.2.1" data-path="../../虚拟化/网络/Linux中的虚拟网络一.html">
            
                <a href="../../虚拟化/网络/Linux中的虚拟网络一.html">
            
                    
                    Linux中的虚拟网络一
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.11.2.2" data-path="../../虚拟化/网络/Linux中的虚拟网络三-OpenStack.html">
            
                <a href="../../虚拟化/网络/Linux中的虚拟网络三-OpenStack.html">
            
                    
                    Linux中的虚拟网络三-OpenStack
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.11.2.3" data-path="../../虚拟化/网络/Linux中的虚拟网络二-Docker.html">
            
                <a href="../../虚拟化/网络/Linux中的虚拟网络二-Docker.html">
            
                    
                    Linux中的虚拟网络二-Docker
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.11.2.4" data-path="../../虚拟化/网络/OVS文档.html">
            
                <a href="../../虚拟化/网络/OVS文档.html">
            
                    
                    OVS文档
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.12" >
            
                <span>
            
                    
                    运维
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.12.1" data-path="../../运维/Ansible优化.html">
            
                <a href="../../运维/Ansible优化.html">
            
                    
                    Ansible优化
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../../读书/">
            
                <a href="../../../读书/">
            
                    
                    读书
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../../../读书/心理学/">
            
                <a href="../../../读书/心理学/">
            
                    
                    心理学
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="../../../读书/心理学/发展心理学/">
            
                <a href="../../../读书/心理学/发展心理学/">
            
                    
                    发展心理学
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="../../../读书/心理学/Common.html">
            
                <a href="../../../读书/心理学/Common.html">
            
                    
                    Common
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../../../读书/理想国/">
            
                <a href="../../../读书/理想国/">
            
                    
                    理想国
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" >
            
                <span>
            
                    
                    Docs
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1.1" data-path="../../../读书/理想国/docs/第七卷-洞穴隐喻.html">
            
                <a href="../../../读书/理想国/docs/第七卷-洞穴隐喻.html">
            
                    
                    第七卷-洞穴隐喻
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../../../读书/瓦尔登湖/">
            
                <a href="../../../读书/瓦尔登湖/">
            
                    
                    瓦尔登湖
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" >
            
                <span>
            
                    
                    Docs
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1.1" data-path="../../../读书/瓦尔登湖/docs/倍克田庄.html">
            
                <a href="../../../读书/瓦尔登湖/docs/倍克田庄.html">
            
                    
                    倍克田庄
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.1.2" data-path="../../../读书/瓦尔登湖/docs/室内的取暖.html">
            
                <a href="../../../读书/瓦尔登湖/docs/室内的取暖.html">
            
                    
                    室内的取暖
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.1.3" data-path="../../../读书/瓦尔登湖/docs/更高的规律.html">
            
                <a href="../../../读书/瓦尔登湖/docs/更高的规律.html">
            
                    
                    更高的规律
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.1.4" data-path="../../../读书/瓦尔登湖/docs/湖.html">
            
                <a href="../../../读书/瓦尔登湖/docs/湖.html">
            
                    
                    湖
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../../../读书/霍乱时期的爱情/">
            
                <a href="../../../读书/霍乱时期的爱情/">
            
                    
                    霍乱时期的爱情
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.1" >
            
                <span>
            
                    
                    Docs
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.1.1" data-path="../../../读书/霍乱时期的爱情/docs/随笔.html">
            
                <a href="../../../读书/霍乱时期的爱情/docs/随笔.html">
            
                    
                    随笔
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../.." >中间件-middleware</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="django-middleware&#x5206;&#x6790;">Django-middleware&#x5206;&#x6790;</h1>
<h2 id="&#x4E00;&#x3001;middleware&#x52A0;&#x8F7D;&#x8FC7;&#x7A0B;-&#x6E90;&#x7801;&#x5206;&#x6790;">&#x4E00;&#x3001;middleware&#x52A0;&#x8F7D;&#x8FC7;&#x7A0B;-&#x6E90;&#x7801;&#x5206;&#x6790;</h2>
<p>django/core/handlers/wsgi.py&#xFF0C; line 122:</p>
<pre><code class="lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WSGIHandler</span><span class="hljs-params">(base.BaseHandler)</span>:</span>
    request_class = WSGIRequest

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, *args, **kwargs)</span>:</span>
        super().__init__(*args, **kwargs)
        self.load_middleware()
</code></pre>
<p>&#x8FFD;&#x8E64;load_middleware, &#x5728;django/core/handlers/base.py, line 23, class BaseHandler:</p>
<pre><code class="lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BaseHandler</span>:</span>
    ...
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">load_middleware</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-string">&quot;&quot;&quot;
        Populate middleware lists from settings.MIDDLEWARE.

        Must be called after the environment is fixed (see __call__ in subclasses).
        &quot;&quot;&quot;</span>
        self._view_middleware = []
        self._template_response_middleware = []
        self._exception_middleware = []

        <span class="hljs-comment"># &#x51FD;&#x6570;&#x5B9A;&#x4E49;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x4E0B;&#x6587;</span>
        <span class="hljs-comment"># &#x5FFD;&#x7565;&#x5F02;&#x5E38;&#x60C5;&#x51B5;&#xFF0C;&#x6B64;&#x5904;&#x53EF;&#x4EE5;&#x7B80;&#x5355;&#x7684;&#x770B;&#x4F5C;&#xFF1A;handler=self._get_response</span>
        handler = convert_exception_to_response(self._get_response)

        <span class="hljs-comment"># note: &#x6B64;&#x5904;&#x4EE5;&#x5012;&#x5E8F;&#x5904;&#x7406;MIDDREWARE</span>
        <span class="hljs-keyword">for</span> middleware_path <span class="hljs-keyword">in</span> reversed(settings.MIDDLEWARE):
            <span class="hljs-comment"># &#x5BFC;&#x5165;middleware</span>
            middleware = import_string(middleware_path)
            <span class="hljs-keyword">try</span>:
                <span class="hljs-comment"># &#x53C2;&#x8003;&#x4E0B;&#x6587;&#x8D34;&#x51FA;&#x7684;MiddlewareMixin&#x6E90;&#x7801;</span>
                <span class="hljs-comment"># &#x5B9E;&#x4F8B;&#x5316;&#x4E00;&#x4E2A;MiddlewareMixin&#x5BF9;&#x8C61;, &#x8BE5;&#x5BF9;&#x8C61;&#x7684;get_response&#x5C5E;&#x6027;&#x8BBE;&#x7F6E;&#x4E3A;handler</span>
                mw_instance = middleware(handler)
            <span class="hljs-keyword">except</span> MiddlewareNotUsed <span class="hljs-keyword">as</span> exc:
                <span class="hljs-keyword">if</span> settings.DEBUG:
                    <span class="hljs-keyword">if</span> str(exc):
                        logger.debug(<span class="hljs-string">&apos;MiddlewareNotUsed(%r): %s&apos;</span>, middleware_path, exc)
                    <span class="hljs-keyword">else</span>:
                        logger.debug(<span class="hljs-string">&apos;MiddlewareNotUsed: %r&apos;</span>, middleware_path)
                <span class="hljs-keyword">continue</span>

            <span class="hljs-keyword">if</span> mw_instance <span class="hljs-keyword">is</span> <span class="hljs-keyword">None</span>:
                <span class="hljs-keyword">raise</span> ImproperlyConfigured(
                    <span class="hljs-string">&apos;Middleware factory %s returned None.&apos;</span> % middleware_path
                )

            <span class="hljs-keyword">if</span> hasattr(mw_instance, <span class="hljs-string">&apos;process_view&apos;</span>):
                self._view_middleware.insert(<span class="hljs-number">0</span>, mw_instance.process_view)
            <span class="hljs-keyword">if</span> hasattr(mw_instance, <span class="hljs-string">&apos;process_template_response&apos;</span>):
                self._template_response_middleware.append(mw_instance.process_template_response)
            <span class="hljs-keyword">if</span> hasattr(mw_instance, <span class="hljs-string">&apos;process_exception&apos;</span>):
                self._exception_middleware.append(mw_instance.process_exception)

               <span class="hljs-comment"># handler&#x66F4;&#x65B0;&#x4E3A;&#x4E00;&#x4E2A;MiddlewareMixin&#x5BF9;&#x8C61;</span>
            <span class="hljs-comment"># &#x4EE5;&#x51FD;&#x6570;&#x5F62;&#x5F0F;&#x8C03;&#x7528;&#x8BE5;&#x5BF9;&#x8C61;&#xFF08;&#x4F8B;mw_instance(request)&#xFF09;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5B9E;&#x9645;&#x8C03;&#x7528;&#x4E86;mw_instance.__call__&#x65B9;&#x6CD5;</span>
            handler = convert_exception_to_response(mw_instance)

        <span class="hljs-comment"># We only assign to this when initialization is complete as it is used</span>
        <span class="hljs-comment"># as a flag for initialization being complete.</span>
        self._middleware_chain = handler
</code></pre>
<p>convert_exception_to_response&#x7684;&#x58F0;&#x660E;&#x5728;django/core/handlers/exception.py, line 18, &#x53EF;&#x4EE5;&#x770B;&#x5230;&#x8BE5;&#x51FD;&#x6570;&#x5B9E;&#x9645;&#x662F;&#x5C01;&#x88C5;&#x4E86;&#x5F02;&#x5E38;&#x5904;&#x7406;:</p>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">convert_exception_to_response</span><span class="hljs-params">(get_response)</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot;
    Wrap the given get_response callable in exception-to-response conversion.

    All exceptions will be converted. All known 4xx exceptions (Http404,
    PermissionDenied, MultiPartParserError, SuspiciousOperation) will be
    converted to the appropriate response, and all other exceptions will be
    converted to 500 responses.

    This decorator is automatically applied to all middleware to ensure that
    no middleware leaks an exception and that the next middleware in the stack
    can rely on getting a response instead of an exception.
    &quot;&quot;&quot;</span>
<span class="hljs-meta">    @wraps(get_response)</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">inner</span><span class="hljs-params">(request)</span>:</span>
        <span class="hljs-keyword">try</span>:
            response = get_response(request)
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> exc:
            response = response_for_exception(request, exc)
        <span class="hljs-keyword">return</span> response
    <span class="hljs-keyword">return</span> inner
</code></pre>
<p>django&#x4E2D;&#x7684;middleware&#x4F1A;&#x4ECE;&#x4E00;&#x4E2A;MiddlewareMixin&#x7EE7;&#x627F;&#xFF0C;&#x5173;&#x4E8E;MiddlewareMixin&#x7684;&#x5B9A;&#x4E49;&#x5728;django/utils/deprecation.py, line 85:</p>
<pre><code class="lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MiddlewareMixin</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, get_response=None)</span>:</span>
        self.get_response = get_response
        super().__init__()

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__call__</span><span class="hljs-params">(self, request)</span>:</span>
        response = <span class="hljs-keyword">None</span>
        <span class="hljs-keyword">if</span> hasattr(self, <span class="hljs-string">&apos;process_request&apos;</span>):
            response = self.process_request(request)
        response = response <span class="hljs-keyword">or</span> self.get_response(request)
        <span class="hljs-keyword">if</span> hasattr(self, <span class="hljs-string">&apos;process_response&apos;</span>):
            response = self.process_response(request, response)
        <span class="hljs-keyword">return</span> response
</code></pre>
<h2 id="&#x4E8C;&#x3001;middleware&#x52A0;&#x8F7D;&#x8FC7;&#x7A0B;-&#x4EE3;&#x7801;&#x8FD0;&#x884C;&#x5206;&#x6790;">&#x4E8C;&#x3001;middleware&#x52A0;&#x8F7D;&#x8FC7;&#x7A0B;-&#x4EE3;&#x7801;&#x8FD0;&#x884C;&#x5206;&#x6790;</h2>
<p>&#x5047;&#x8BBE;&#x5B9A;&#x4E49;setting.MIDDLEWARE&#x5B9A;&#x4E49;&#x4E3A;[A, B, C]&#xFF0C;&#x90A3;&#x4E48;&#x4E0A;&#x9762;&#x8FC7;&#x7A0B;&#x53EF;&#x4EE5;&#x63CF;&#x8FF0;&#x4E3A;&#xFF1A;</p>
<pre><code class="lang-python">handler = wrapped(self._get_response)  <span class="hljs-comment"># BaseHandler._get_response</span>
<span class="hljs-keyword">for</span> M <span class="hljs-keyword">in</span> [C, B, A]:
    <span class="hljs-keyword">import</span> A
    m_instance = M(handler) <span class="hljs-comment"># m_instance.get_response = handler</span>
    handler = wrapped(m_instance) <span class="hljs-comment"># m_instance.__call__</span>

self._middleware_chain = handler <span class="hljs-comment"># A.__call__</span>
</code></pre>
<p>&#x8FD0;&#x884C;&#x540E;&#x7684;&#x7ED3;&#x679C;&#x4E3A;&#xFF1A;</p>
<p><strong>note: &#x4E3A;&#x7B80;&#x5316;&#x5206;&#x6790;&#x8FC7;&#x7A0B;&#xFF0C;&#x6B64;&#x5904;&#x5FFD;&#x7565;&#x4E86;&#x5F02;&#x5E38;&#x60C5;&#x51B5;</strong></p>
<p><strong>&#x5B9E;&#x9645;&#x9700;&#x8003;&#x8651;convert<em>exception<em>to_response&#xFF0C;&#x5B8C;&#x6574;&#x7684;A.get_response&#x5E94;&#x8BE5;&#x4E3A;convert_exception_to_response(B.__call</em></em>)</strong></p>
<pre><code class="lang-python">C.get_response = BaseHandler._get_response
B.get_response = C.__call__
A.get_response = B.__call__
self._middleware_chain = A.__call__
</code></pre>
<h2 id="&#x4E09;&#x3001;request&#x5904;&#x7406;&#x8FC7;&#x7A0B;-&#x6E90;&#x7801;&#x5206;&#x6790;">&#x4E09;&#x3001;request&#x5904;&#x7406;&#x8FC7;&#x7A0B;-&#x6E90;&#x7801;&#x5206;&#x6790;</h2>
<p>django/core/handlers/wsgi.py, line 133, class WSGIHandler:</p>
<pre><code class="lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WSGIHandler</span><span class="hljs-params">(base.BaseHandler)</span>:</span>
    request_class = WSGIRequest

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, *args, **kwargs)</span>:</span>
        super().__init__(*args, **kwargs)
        self.load_middleware()

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__call__</span><span class="hljs-params">(self, environ, start_response)</span>:</span>
        set_script_prefix(get_script_name(environ))
        signals.request_started.send(sender=self.__class__, environ=environ)
        request = self.request_class(environ)

        <span class="hljs-comment"># &#x83B7;&#x53D6;response</span>
        response = self.get_response(request)

        response._handler_class = self.__class__

        status = <span class="hljs-string">&apos;%d %s&apos;</span> % (response.status_code, response.reason_phrase)
        response_headers = [
            *response.items(),
            *((<span class="hljs-string">&apos;Set-Cookie&apos;</span>, c.output(header=<span class="hljs-string">&apos;&apos;</span>)) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> response.cookies.values()),
        ]
        start_response(status, response_headers)
        <span class="hljs-keyword">if</span> getattr(response, <span class="hljs-string">&apos;file_to_stream&apos;</span>, <span class="hljs-keyword">None</span>) <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">None</span> <span class="hljs-keyword">and</span> environ.get(<span class="hljs-string">&apos;wsgi.file_wrapper&apos;</span>):
            <span class="hljs-comment"># If `wsgi.file_wrapper` is used the WSGI server does not call</span>
            <span class="hljs-comment"># .close on the response, but on the file wrapper. Patch it to use</span>
            <span class="hljs-comment"># response.close instead which takes care of closing all files.</span>
            response.file_to_stream.close = response.close
            response = environ[<span class="hljs-string">&apos;wsgi.file_wrapper&apos;</span>](response.file_to_stream, response.block_size)
        <span class="hljs-keyword">return</span> response
</code></pre>
<p>&#x8FFD;&#x8E64;, &#x5728;django/core/handlers/base.py, line 71, class BaseHandler:</p>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_response</span><span class="hljs-params">(self, request)</span>:</span>
        <span class="hljs-string">&quot;&quot;&quot;Return an HttpResponse object for the given HttpRequest.&quot;&quot;&quot;</span>
        <span class="hljs-comment"># Setup default url resolver for this thread</span>
        set_urlconf(settings.ROOT_URLCONF)

        <span class="hljs-comment"># middleware&#x4F9D;&#x6B21;&#x5904;&#x7406;</span>
        response = self._middleware_chain(request)
        response._resource_closers.append(request.close)
        <span class="hljs-keyword">if</span> response.status_code &gt;= <span class="hljs-number">400</span>:
            log_response(
                <span class="hljs-string">&apos;%s: %s&apos;</span>, response.reason_phrase, request.path,
                response=response,
                request=request,
            )
        <span class="hljs-keyword">return</span> response
</code></pre>
<p>&#x53C2;&#x8003;&#x4E0A;&#x6587;&#x3010;middleware&#x52A0;&#x8F7D;&#x8FC7;&#x7A0B;-&#x4EE3;&#x7801;&#x8FD0;&#x884C;&#x5206;&#x6790;&#x3011;&#x7684;&#x4F8B;&#x5B50;&#xFF0C;middleware&#x5904;&#x7406;&#x8FC7;&#x7A0B;&#x53EF;&#x770B;&#x4F5C;&#xFF1A;</p>
<pre><code class="lang-python">A.__call__(request):
    response = <span class="hljs-keyword">None</span>
    <span class="hljs-keyword">if</span> hasattr(self, <span class="hljs-string">&apos;process_request&apos;</span>):
        response = self.process_request(request)
    <span class="hljs-comment"># &#x66FF;&#x6362;</span>
    response = response <span class="hljs-keyword">or</span> self.get_response(request)
    <span class="hljs-keyword">if</span> hasattr(self, <span class="hljs-string">&apos;process_response&apos;</span>):
        response = self.process_response(request, response)
        <span class="hljs-keyword">return</span> response
</code></pre>
<p>&#x7ED3;&#x5408;&#x4E0A;&#x6587;MiddlewareMixin.<strong>call</strong>&#x7684;&#x6E90;&#x7801;&#xFF0C;&#x6B64;&#x5904;&#x5B9E;&#x9645;&#x662F;&#x94FE;&#x5F0F;&#x8C03;&#x7528;&#xFF0C;&#x4F9D;&#x6B21;&#x8C03;&#x7528;</p>
<p>A.<strong>call</strong> -&gt; B.<strong>call</strong> -&gt; C.<strong>call</strong> -&gt; BaseHandler._get_response&#xFF0C;&#x5373;&#xFF1A;</p>
<p>A.process_request --&gt; B.process_request --&gt; C.process_request --&gt; BaseHandler._get_response --&gt; BaseHandler._process_response -- &gt; C.process_response --&gt; B.process_response --&gt; A.process_response</p>
<p>&#x8D34;&#x4E00;&#x4E0B;BaseHandler._get_response&#x7684;&#x6E90;&#x7801;:</p>
<pre><code class="lang-python">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_get_response</span><span class="hljs-params">(self, request)</span>:</span>
        <span class="hljs-string">&quot;&quot;&quot;
        Resolve and call the view, then apply view, exception, and
        template_response middleware. This method is everything that happens
        inside the request/response middleware.
        &quot;&quot;&quot;</span>
        response = <span class="hljs-keyword">None</span>

        <span class="hljs-keyword">if</span> hasattr(request, <span class="hljs-string">&apos;urlconf&apos;</span>):
            urlconf = request.urlconf
            set_urlconf(urlconf)
            resolver = get_resolver(urlconf)
        <span class="hljs-keyword">else</span>:
            resolver = get_resolver()

        resolver_match = resolver.resolve(request.path_info)
        callback, callback_args, callback_kwargs = resolver_match
        request.resolver_match = resolver_match

        <span class="hljs-comment"># Apply view middleware</span>
        <span class="hljs-keyword">for</span> middleware_method <span class="hljs-keyword">in</span> self._view_middleware:
            response = middleware_method(request, callback, callback_args, callback_kwargs)
            <span class="hljs-keyword">if</span> response:
                <span class="hljs-keyword">break</span>

        <span class="hljs-keyword">if</span> response <span class="hljs-keyword">is</span> <span class="hljs-keyword">None</span>:
            wrapped_callback = self.make_view_atomic(callback)
            <span class="hljs-keyword">try</span>:
                response = wrapped_callback(request, *callback_args, **callback_kwargs)
            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
                response = self.process_exception_by_middleware(e, request)

        <span class="hljs-comment"># Complain if the view returned None (a common error).</span>
        <span class="hljs-keyword">if</span> response <span class="hljs-keyword">is</span> <span class="hljs-keyword">None</span>:
            <span class="hljs-keyword">if</span> isinstance(callback, types.FunctionType):    <span class="hljs-comment"># FBV</span>
                view_name = callback.__name__
            <span class="hljs-keyword">else</span>:                                           <span class="hljs-comment"># CBV</span>
                view_name = callback.__class__.__name__ + <span class="hljs-string">&apos;.__call__&apos;</span>

            <span class="hljs-keyword">raise</span> ValueError(
                <span class="hljs-string">&quot;The view %s.%s didn&apos;t return an HttpResponse object. It &quot;</span>
                <span class="hljs-string">&quot;returned None instead.&quot;</span> % (callback.__module__, view_name)
            )

        <span class="hljs-comment"># If the response supports deferred rendering, apply template</span>
        <span class="hljs-comment"># response middleware and then render the response</span>
        <span class="hljs-keyword">elif</span> hasattr(response, <span class="hljs-string">&apos;render&apos;</span>) <span class="hljs-keyword">and</span> callable(response.render):
            <span class="hljs-keyword">for</span> middleware_method <span class="hljs-keyword">in</span> self._template_response_middleware:
                response = middleware_method(request, response)
                <span class="hljs-comment"># Complain if the template response middleware returned None (a common error).</span>
                <span class="hljs-keyword">if</span> response <span class="hljs-keyword">is</span> <span class="hljs-keyword">None</span>:
                    <span class="hljs-keyword">raise</span> ValueError(
                        <span class="hljs-string">&quot;%s.process_template_response didn&apos;t return an &quot;</span>
                        <span class="hljs-string">&quot;HttpResponse object. It returned None instead.&quot;</span>
                        % (middleware_method.__self__.__class__.__name__)
                    )

            <span class="hljs-keyword">try</span>:
                response = response.render()
            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
                response = self.process_exception_by_middleware(e, request)

        <span class="hljs-keyword">return</span> response
</code></pre>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;url&#x89E3;&#x6790;&#x5373;&#x5728;&#x6B64;&#x5904;&#x5B8C;&#x6210;&#xFF0C;&#x6B64;&#x5916;&#x8FD8;&#x6709;&#x89C6;&#x56FE;&#x548C;&#x6E32;&#x67D3;&#x7B49;&#x529F;&#x80FD;&#x4E5F;&#x5728;&#x6B64;&#x5904;&#x8C03;&#x7528;&#x3002;</p>
<h1 id="&#x53C2;&#x8003;">&#x53C2;&#x8003;</h1>
<p><a href="https://blog.csdn.net/Fe_cow/article/details/91344472" target="_blank">&#x53C2;&#x8003;&#x4E00;: Django&#x4E2D;&#x95F4;&#x4EF6;&#x8BE6;&#x89E3;</a></p>
<p><a href="https://www.runoob.com/django/django-middleware.html" target="_blank">&#x53C2;&#x8003;&#x4E8C;: Django&#x4E2D;&#x95F4;&#x4EF6;</a></p>
<p><a href="https://www.cnblogs.com/276815076/p/9593419.html" target="_blank">&#x53C2;&#x8003;&#x4E09;: &#x81EA;&#x5B9A;&#x4E49;Django&#x4E2D;&#x95F4;&#x4EF6;</a></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                
                <a href="性能分析工具-silk.html" class="navigation navigation-next navigation-unique" aria-label="Next page: 性能分析工具-silk">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"中间件-middleware","level":"1.2.8.1.1","depth":4,"next":{"title":"性能分析工具-silk","level":"1.2.8.1.2","depth":4,"path":"IT/框架/Django/性能分析工具-silk.md","ref":"IT/框架/Django/性能分析工具-silk.md","articles":[]},"previous":{"title":"Django","level":"1.2.8.1","depth":3,"ref":"","articles":[{"title":"中间件-middleware","level":"1.2.8.1.1","depth":4,"path":"IT/框架/Django/中间件-middleware.md","ref":"IT/框架/Django/中间件-middleware.md","articles":[]},{"title":"性能分析工具-silk","level":"1.2.8.1.2","depth":4,"path":"IT/框架/Django/性能分析工具-silk.md","ref":"IT/框架/Django/性能分析工具-silk.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["expandable-chapters","chapter-fold"],"ignores":["node_modules"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"expandable-chapters":{},"chapter-fold":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"gitbook":"*"},"file":{"path":"IT/框架/Django/中间件-middleware.md","mtime":"2021-02-16T07:02:13.738Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-03-28T13:54:49.004Z"},"basePath":"../../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../../gitbook/gitbook.js"></script>
    <script src="../../../gitbook/theme.js"></script>
    
        
        <script src="../../../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-chapter-fold/chapter-fold.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

